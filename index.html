<!DOCTYPE html>

<link rel = "stylesheet" type = "text/css" href = "main.css"/>
<script src ="./babylonjs/babylon.js"></script>
<script src ="./hand/hand.js"></script>
<script src ="./cannon/src/cannon.js"></script>

<script src ="./netCode.js"></script>

<script src ="./hashmap/hashmap.js"></script>


<head>
	<title>Virtuoso Browser Client - Pre-Alpha 0.0.1</title>
</head>

<canvas id="renderCanvas"></canvas>
<body>
	<script>
		users = new HashMap();
		var sphere;
		startRepeatingGet(users);
		var canvas = document.getElementById("renderCanvas");
		var engine = new BABYLON.Engine(canvas, true);
		
		var createScene = function()
		{
			var scene = new BABYLON.Scene(engine);
			
			scene.clearColor = new BABYLON.Color3(0, 1, 0);
			
			var camera = new BABYLON.FreeCamera("camera1", new BABYLON.Vector3(0, 5, -10), scene);
			
			camera.setTarget(BABYLON.Vector3.Zero());
			
			camera.attachControl(canvas, false);
			
			var light = new BABYLON.HemisphericLight("light1", new BABYLON.Vector3(0, 1, 0), scene);
			
			light.intensity = 0.5;
			
			sphere = BABYLON.Mesh.CreateSphere("sphere1", 16, 2, scene);
			sphere.position.y = 1;
			
			//var ground = BABYLON.Mesh.CreateGround("ground1", 6, 6, 2, scene);
			
			return scene;
		}
		
		var scene = createScene();
		
		engine.runRenderLoop(function()
		{
			scene.render();
			
			var contin = users.get("continuumspooky");
			//var gg = contin.toString();
			
			var gg = String(contin);
			gg = gg.split(",");
			newPos = [parseFloat(gg[0]), parseFloat(gg[1]), parseFloat(gg[2])];
			
			//console.log(gg);
			
			sphere.position = new BABYLON.Vector3(newPos[0], newPos[1], newPos[2]);
			console.log(sphere.position);
		});
		
		window.addEventListener("resize", function()
		{
			engine.resize();
		});
	</script>
</body>
</html>